# ç´«å¾®æ–—æ•° MCP æœåŠ¡å™¨

ä¸€ä¸ªåŸºäº Model Context Protocol (MCP) çš„ä¸“ä¸šç´«å¾®æ–—æ•°å‘½ç†åˆ†ææœåŠ¡å™¨ï¼Œæä¾›å®Œæ•´çš„å‘½ç›˜ç”Ÿæˆã€è§£è¯»ã€åˆ†æå’Œå¯è§†åŒ–åŠŸèƒ½ã€‚æ”¯æŒä¼ ç»Ÿç´«å¾®æ–—æ•°ç®—æ³•ï¼Œé›†æˆç°ä»£æ•°æ®æŒä¹…åŒ–å’Œå¯è§†åŒ–æŠ€æœ¯ã€‚

## ğŸŒŸ åŠŸèƒ½ç‰¹ç‚¹

### æ ¸å¿ƒåŠŸèƒ½
- ğŸ”® **å‘½ç›˜ç”Ÿæˆ**: åŸºäºå†œå†ç®—æ³•ç”Ÿæˆå®Œæ•´çš„ç´«å¾®æ–—æ•°å‘½ç›˜
- ğŸ“– **å‘½ç›˜è§£è¯»**: æä¾›è¯¦ç»†çš„å‘½ç›˜åˆ†æå’Œä¸“ä¸šè§£é‡Š
- ğŸŒŸ **è¿åŠ¿åˆ†æ**: åˆ†æå½“å‰å’Œæœªæ¥çš„è¿åŠ¿èµ°å‘
- ğŸ’• **åˆå©šåˆ†æ**: åŒäººå‘½ç›˜åˆå©šé…å¯¹åˆ†æ
- ğŸ“… **æ‹©æ—¥åŠŸèƒ½**: æ ¹æ®å‘½ç›˜é€‰æ‹©å‰æ—¥è‰¯è¾°
- ğŸ¤– **AIæ™ºèƒ½è§£ç›˜**: ç»“åˆä¼ ç»Ÿå‘½ç†ä¸ç°ä»£AIæŠ€æœ¯

### å¯è§†åŒ–åŠŸèƒ½
- ğŸ¨ **å‘½ç›˜å›¾åƒ**: ç”Ÿæˆå¤šç§æ ·å¼çš„å¯è§†åŒ–å‘½ç›˜å›¾è¡¨
- ğŸ“Š **æ•°æ®å¯è§†åŒ–**: æ”¯æŒSVGã€PNGã€HTMLå¤šç§æ ¼å¼è¾“å‡º
- ğŸ­ **ä¸»é¢˜å®šåˆ¶**: ä¼ ç»Ÿã€ç°ä»£ã€å½©è‰²ã€å•è‰²ç­‰å¤šç§é…è‰²æ–¹æ¡ˆ

### ä¸“ä¸šåˆ†æ
- â­ **æ˜Ÿæ›œä¿¡æ¯**: æŸ¥è¯¢å„ä¸ªæ˜Ÿæ›œçš„è¯¦ç»†ä¿¡æ¯å’Œå½±å“
- ğŸ  **å®«ä½åˆ†æ**: è·å–åäºŒå®«ä½çš„å«ä¹‰å’Œæ·±åº¦åˆ†æ
- ğŸ“ˆ **äººç”Ÿæ—¶é—´è½´**: å¤§è¿æµå¹´è¯¦ç»†åˆ†æ
- ğŸ‘¥ **äººé™…å…³ç³»**: å®¶åº­ã€æœ‹å‹ã€äº‹ä¸šå…³ç³»åˆ†æ
- ğŸ’¼ **èŒä¸šæŒ‡å¯¼**: èŒä¸šå‘å±•å’Œå†³ç­–æ”¯æŒ
- ğŸ¥ **å¥åº·åˆ†æ**: å¥åº·è¶‹åŠ¿å’Œå…»ç”Ÿå»ºè®®
- ğŸ“ **æ•™è‚²æŒ‡å¯¼**: å­¦ä¹ èƒ½åŠ›å’Œæ•™è‚²è§„åˆ’

## ğŸ“¦ å®‰è£…

### ç¯å¢ƒè¦æ±‚
- Node.js 18.0+
- npm 8.0+
- SQLite 3.0+

### å®‰è£…ä¾èµ–

```bash
npm install
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨æœåŠ¡å™¨

```bash
# å¼€å‘æ¨¡å¼
npm run dev

# ç”Ÿäº§æ¨¡å¼
npm start
```

### å®¢æˆ·ç«¯é…ç½® (stdio)

å¦‚æœæ‚¨ä½¿ç”¨æ”¯æŒMCPçš„å®¢æˆ·ç«¯ï¼ˆå¦‚Claude Desktopï¼‰ï¼Œå¯ä»¥é€šè¿‡stdioæ–¹å¼è¿æ¥åˆ°æœ¬æœåŠ¡ï¼š

#### Claude Desktopé…ç½®

åœ¨Claude Desktopçš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š

```json
{
  "mcpServers": {
    "ziwei-doushu": {
      "command": "npx",
      "args": ["-y","ziwei-mcp"]
    }
  }
}
```


## ğŸ“š API æ–‡æ¡£

### æ ¸å¿ƒå·¥å…·

#### 1. generate_chart - ç”Ÿæˆå‘½ç›˜
ç”Ÿæˆå®Œæ•´çš„ç´«å¾®æ–—æ•°å‘½ç›˜

**å‚æ•°:**
- `name` (string): å§“å
- `birthDate` (string): å‡ºç”Ÿæ—¥æœŸ (YYYY-MM-DD)
- `birthTime` (string): å‡ºç”Ÿæ—¶é—´ (HH:MM)
- `gender` (string): æ€§åˆ« (male/female)
- `location` (object): å‡ºç”Ÿåœ°ç‚¹
  - `province` (string): çœä»½
  - `city` (string): åŸå¸‚
  - `longitude` (number): ç»åº¦
  - `latitude` (number): çº¬åº¦
- `timezone` (string): æ—¶åŒº (é»˜è®¤: Asia/Shanghai)
- `calendar` (string): å†æ³• (solar/lunarï¼Œé»˜è®¤: solar)

#### 2. interpret_chart - å‘½ç›˜è§£è¯»
æä¾›è¯¦ç»†çš„å‘½ç›˜åˆ†æå’Œè§£é‡Š

**å‚æ•°:**
- `chartId` (string): å‘½ç›˜ID
- `aspects` (array): è§£è¯»æ–¹é¢
  - personality: æ€§æ ¼ç‰¹è´¨
  - career: äº‹ä¸šå‘å±•
  - wealth: è´¢å¯Œè¿åŠ¿
  - relationships: æ„Ÿæƒ…å…³ç³»
  - health: å¥åº·çŠ¶å†µ
  - family: å®¶åº­å…³ç³»
- `detailLevel` (string): è¯¦ç»†ç¨‹åº¦ (basic/detailed/comprehensive)

#### 3. analyze_fortune - è¿åŠ¿åˆ†æ
åˆ†æç‰¹å®šæ—¶æœŸçš„è¿åŠ¿èµ°å‘

**å‚æ•°:**
- `chartId` (string): å‘½ç›˜ID
- `period` (string): åˆ†æå‘¨æœŸ (current_year/next_year/decade/custom)
- `startDate` (string): å¼€å§‹æ—¥æœŸ (YYYY-MM-DD)
- `endDate` (string): ç»“æŸæ—¥æœŸ (YYYY-MM-DD)
- `aspects` (array): åˆ†ææ–¹é¢

#### 4. analyze_compatibility - åˆå©šåˆ†æ
åŒäººå‘½ç›˜åˆå©šé…å¯¹åˆ†æ

**å‚æ•°:**
- `chart1Id` (string): ç¬¬ä¸€äººå‘½ç›˜ID
- `chart2Id` (string): ç¬¬äºŒäººå‘½ç›˜ID
- `analysisType` (string): åˆ†æç±»å‹ (marriage/business/friendship)
- `aspects` (array): åˆ†æç»´åº¦

#### 5. select_auspicious_date - æ‹©æ—¥åŠŸèƒ½
æ ¹æ®å‘½ç›˜é€‰æ‹©å‰æ—¥è‰¯è¾°

**å‚æ•°:**
- `chartId` (string): å‘½ç›˜ID
- `eventType` (string): äº‹ä»¶ç±»å‹
- `dateRange` (object): æ—¥æœŸèŒƒå›´
- `preferences` (object): åå¥½è®¾ç½®

### å¯è§†åŒ–å·¥å…·

#### 6. generate_visualization - ç”Ÿæˆå¯è§†åŒ–å›¾è¡¨
ç”Ÿæˆå‘½ç›˜å¯è§†åŒ–å›¾è¡¨ï¼Œæ”¯æŒå¤šç§æ ·å¼å’Œæ ¼å¼

**å‚æ•°:**
- `chartId` (string): å‘½ç›˜ID
- `visualizationType` (string): å¯è§†åŒ–ç±»å‹
  - traditional_chart: ä¼ ç»Ÿå‘½ç›˜
  - modern_wheel: ç°ä»£è½®ç›˜
  - palace_grid: å®«ä½ç½‘æ ¼
  - star_map: æ˜Ÿæ›œåœ°å›¾
- `includeElements` (array): åŒ…å«å…ƒç´ 
- `colorScheme` (string): é…è‰²æ–¹æ¡ˆ
- `outputFormat` (string): è¾“å‡ºæ ¼å¼ (svg/png/html)

### ä¸“ä¸šåˆ†æå·¥å…·

#### 7. analyze_life_timeline - äººç”Ÿæ—¶é—´è½´åˆ†æ
åˆ†æäººç”Ÿæ—¶é—´è½´ï¼ŒåŒ…æ‹¬å¤§è¿æµå¹´è¯¦ç»†åˆ†æ

#### 8. analyze_relationships - äººé™…å…³ç³»åˆ†æ
åˆ†æäººé™…å…³ç³»ï¼ŒåŒ…æ‹¬å®¶åº­ã€æœ‹å‹ã€åŒäº‹ç­‰

#### 9. career_guidance - èŒä¸šå‘å±•æŒ‡å¯¼
èŒä¸šå‘å±•æŒ‡å¯¼å’Œå†³ç­–æ”¯æŒ

#### 10. health_analysis - å¥åº·åˆ†æ
å¥åº·åˆ†æå’Œå…»ç”Ÿå»ºè®®

#### 11. educational_guidance - æ•™è‚²æŒ‡å¯¼
æ•™è‚²å’Œå­¦ä¹ æŒ‡å¯¼

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### å¼€å‘ç¯å¢ƒè®¾ç½®

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd ç´«å¾®æ–—æ•°

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨MCPæœåŠ¡å™¨
npm start

# æˆ–å¯åŠ¨å¼€å‘æ¨¡å¼
npm run dev
```

### å¯ç”¨è„šæœ¬

```bash
npm start      # å¯åŠ¨MCPæœåŠ¡å™¨
npm run dev    # å¯åŠ¨å¼€å‘æ¨¡å¼ï¼ˆå¸¦è°ƒè¯•ï¼‰
npm test       # è¿è¡ŒåŸºç¡€æµ‹è¯•
npm run lint   # ESLintä»£ç æ£€æŸ¥
npm run format # Prettierä»£ç æ ¼å¼åŒ–
```

### ä»£ç è§„èŒƒ

- ä½¿ç”¨ ESLint è¿›è¡Œä»£ç æ£€æŸ¥
- ä½¿ç”¨ Prettier è¿›è¡Œä»£ç æ ¼å¼åŒ–
- éµå¾ª CommonJS æ¨¡å—è§„èŒƒ
- æ”¯æŒ Node.js 18.0+ ç‰ˆæœ¬

## ğŸ”§ é…ç½®è¯´æ˜

### é…ç½®æ–‡ä»¶

é¡¹ç›®ä½¿ç”¨ä»¥ä¸‹é…ç½®æ–‡ä»¶ï¼š

- `config/sqlite-config.js` - SQLiteæ•°æ®åº“é…ç½®
- `config/persistence-config.js` - æ•°æ®æŒä¹…åŒ–é…ç½®
- `package.json` - é¡¹ç›®ä¾èµ–å’Œè„šæœ¬é…ç½®

### æ•°æ®åº“é…ç½®

é¡¹ç›®ä½¿ç”¨ SQLite ä½œä¸ºæ•°æ®å­˜å‚¨ï¼Œé…ç½®æ–‡ä»¶ä½äº `config/sqlite-config.js`ã€‚

## ğŸ“– ä½¿ç”¨ç¤ºä¾‹

### ç”Ÿæˆå‘½ç›˜ç¤ºä¾‹

```javascript
// é€šè¿‡MCPè°ƒç”¨
const chart = await mcpClient.callTool('generate_chart', {
  name: 'å¼ ä¸‰',
  birthDate: '1990-01-01',
  birthTime: '08:30',
  gender: 'male',
  location: {
    province: 'åŒ—äº¬å¸‚',
    city: 'åŒ—äº¬å¸‚',
    longitude: 116.4074,
    latitude: 39.9042
  }
});
```

### å‘½ç›˜è§£è¯»ç¤ºä¾‹

```javascript
const interpretation = await mcpClient.callTool('interpret_chart', {
  chartId: chart.id,
  aspects: ['personality', 'career', 'wealth'],
  detailLevel: 'detailed'
});
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

### æäº¤è§„èŒƒ

```
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: ä»£ç é‡æ„
test: æµ‹è¯•ç›¸å…³
chore: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨
```

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚

## ğŸ†˜ æ”¯æŒä¸åé¦ˆ

- ğŸ“š è¯¦ç»†æ–‡æ¡£: [ç´«å¾®æ–—æ•°MCPå¼€å‘æ–‡æ¡£](./ç´«å¾®æ–—æ•°MCPå¼€å‘æ–‡æ¡£.md)
- ğŸ“‹ SQLiteéƒ¨ç½²: [SQLiteéƒ¨ç½²æŒ‡å—](./SQLiteéƒ¨ç½²æŒ‡å—.md)
- ğŸ¨ SVGç”Ÿæˆ: [SVGç”Ÿæˆå™¨ä½¿ç”¨æŒ‡å—](./SVGç”Ÿæˆå™¨ä½¿ç”¨æŒ‡å—.md)

## ğŸ”— ç›¸å…³é“¾æ¥

- [Model Context Protocol](https://modelcontextprotocol.io/)
- [Claude Desktop](https://claude.ai/desktop)
- [lunar-javascriptåº“](https://github.com/6tail/lunar-javascript) - å†œå†è½¬æ¢æ ¸å¿ƒåº“

---

**æ³¨æ„**: æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œå‘½ç†åˆ†æç»“æœä»…ä¾›å‚è€ƒï¼Œä¸åº”ä½œä¸ºäººç”Ÿé‡å¤§å†³ç­–çš„å”¯ä¸€ä¾æ®ã€‚

## ğŸ“‹ æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-01-01)
- âœ¨ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- ğŸ”® å®ç°åŸºç¡€å‘½ç›˜ç”ŸæˆåŠŸèƒ½
- ğŸ“– æ”¯æŒå‘½ç›˜è§£è¯»å’Œè¿åŠ¿åˆ†æ
- ğŸ¨ æ·»åŠ SVGå›¾åƒç”Ÿæˆ
- ğŸ’¾ é›†æˆSQLiteæ•°æ®æŒä¹…åŒ–
- ğŸ¤– æ”¯æŒAIæ™ºèƒ½è§£ç›˜
- ğŸ’• æ·»åŠ åˆå©šåˆ†æåŠŸèƒ½
- ğŸ“… å®ç°æ‹©æ—¥åŠŸèƒ½

## â“ å¸¸è§é—®é¢˜

**Q: ä¸ºä»€ä¹ˆç”Ÿæˆçš„å‘½ç›˜ä¸å…¶ä»–è½¯ä»¶ä¸åŒï¼Ÿ**
A: ä¸åŒçš„ç´«å¾®æ–—æ•°è½¯ä»¶å¯èƒ½ä½¿ç”¨ä¸åŒçš„ç®—æ³•å’Œå‚æ•°ï¼Œæœ¬æœåŠ¡åŸºäºä¼ ç»Ÿç®—æ³•å®ç°ï¼Œç»“æœå¯èƒ½å­˜åœ¨å·®å¼‚ã€‚

**Q: æ”¯æŒå“ªäº›åœ°åŒºçš„æ—¶åŒºï¼Ÿ**
A: æ”¯æŒå…¨çƒä¸»è¦æ—¶åŒºï¼Œé»˜è®¤ä½¿ç”¨Asia/Shanghaiï¼ˆåŒ—äº¬æ—¶é—´ï¼‰ã€‚

**Q: æ•°æ®ä¼šä¿å­˜å¤šé•¿æ—¶é—´ï¼Ÿ**
A: ç›®å‰æ•°æ®ä¼šæ°¸ä¹…ä¿å­˜åœ¨æœ¬åœ°SQLiteæ•°æ®åº“ä¸­ï¼Œæ‚¨å¯ä»¥æ‰‹åŠ¨æ¸…ç†ä¸éœ€è¦çš„æ•°æ®ã€‚

**Q: å¦‚ä½•è·å¾—æ›´å‡†ç¡®çš„åˆ†æç»“æœï¼Ÿ**
A: è¯·ç¡®ä¿è¾“å…¥å‡†ç¡®çš„å‡ºç”Ÿæ—¥æœŸã€æ—¶é—´å’Œåœ°ç‚¹ä¿¡æ¯ï¼Œæ—¶é—´ç²¾ç¡®åˆ°åˆ†é’Ÿçº§åˆ«ã€‚

## ğŸ”§ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°æŠ€æœ¯é—®é¢˜ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š
1. é”™è¯¯ä¿¡æ¯å’Œé”™è¯¯ä»£ç 
2. è¾“å…¥çš„å‚æ•°ä¿¡æ¯
3. æ“ä½œç³»ç»Ÿå’ŒNode.jsç‰ˆæœ¬
4. è¯¦ç»†çš„æ“ä½œæ­¥éª¤

è§£é‡Šæ•°æ®